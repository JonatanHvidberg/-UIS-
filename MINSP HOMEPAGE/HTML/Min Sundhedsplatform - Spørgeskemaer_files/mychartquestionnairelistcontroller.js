/*! Copyright (c) Epic Systems Corporation 2017-2018 */
var Epic;(function(a){var b;(function(b){var c;(function(b){var c;(function(d){var c=function(){var c="#divQnrQuestionnaire";function QuestionnaireListController(){this.stringNamespace="QuestionnaireList.MyChart";this.qnrHandler={questionnaireCallback:$.proxy(function questionnaireCallback(g,h,f){var d=".questionnairelocked",a=".noquestions",e;b.Utility.hideElement($afe.select(c));this.qnrController=null;if(g===b.QuestionnaireAction.Error){if(f===b.QuestionnaireError.NoQuestions){e=$afe.renderTemplate($$WP.Templates.Questionnaire.NoQuestionsHyperspace,{},"");$afe.select(a).empty().safePrepend(e);$afe.select("img.noquestions").attr("src",makeStaticImageLink(b.QuestionnaireImageKeys.Warning));b.Utility.showElement($afe.select(a))}else if(f===b.QuestionnaireError.QuestionnaireLocked){e=$afe.renderTemplate($$WP.Templates.Questionnaire.QuestionnaireLockedHyperspace,{MessageKey:b.QuestionnaireStringKeys.Locked},"");$afe.select(d).empty().safePrepend(e);$afe.select("img.interrupticon_warn").attr("src",makeStaticImageLink(b.QuestionnaireImageKeys.Yield));b.Utility.showElement($afe.select(d))}else if(f===b.QuestionnaireError.WebServerError){b.Utility.showError();return}b.ListUtility.showPageElements(this.callingApp);$$WP.Utilities.UI.MatchColumnHeights()}else location.reload()},this)}}QuestionnaireListController.prototype.start=function(d,c){var a=this;if(d===void 0)d="";if(c===void 0)c=false;b.Utility.hideElement($afe.select(".back"));$.ajax({url:makeLink("Questionnaire/MyChartQuestionnaire/GetQuestionnaireList"),type:"POST",data:$$WPUtil.postify({filterDAT:d,filterSeriesByDAT:c}),success:function(c){a.callingApp=c.CallingApp;if(a.callingApp===b.CallingApplication.Hyperspace)a.stringNamespace="QuestionnaireList.Hyperspace";a.populateLists(c)},error:function(){b.Utility.showError()}})};QuestionnaireListController.prototype.populateLists=function(a){var d=this,f,h=a.AssignedQuestionnaires.length,i=a.OptionalQuestionnaires.length;a.Mobile=$$WP.Utilities.UI.IsMobile;for(var e=0,g=a.OptionalQuestionnaires;e<g.length;e++){var c=g[e];c.OptionalQuestionnaireFilledOut=b.QuestionnaireListHoverHelpTextKeys.OptionalQuestionnaireFilledOut;c.OptionalQuestionnaireNeverFilledOut=b.QuestionnaireListHoverHelpTextKeys.OptionalQuestionnaireNeverFilledOut;c.Mnemonics={QuestionnaireName:{Value:c.Questionnaire.Name},QuestionnaireDescription:{Value:c.Description},FilledOutDate:{Value:c.LastFilledOutISO}}}f=$afe.renderTemplate($$WP.Templates.Questionnaire.QuestionnaireList,a,"");$afe.select(".listpage").safePrepend(f);b.ListUtility.addEventHandlers();d.questionnaireListData=a;b.ListUtility.addDescriptions(d.callingApp,d.questionnaireListData);d.addStartClickEvents();if(a.Mobile)b.ListUtilityMobile.modifyPageForMobile(h,i);else a.ShowBackButton&&b.Utility.showElement($afe.select(".back"));$$WP.Utilities.UI.MatchColumnHeights();$afe.select(".listpage > .qnr-spinner").addClass("jqHidden").hide()};QuestionnaireListController.prototype.addStartClickEvents=function(){var b,a;b=$afe.select(".qnr_list_table tbody tr.clickable");var c=function(){var c=$afe.jq(b[a]);c.on("click",$.proxy(function(){this.startQnrController(c.data("qnr-id"),c.data("context-type"),c.data("context-identifier"),c.data("is-history"),c.data("hist-ctx"),c.data("hist-ctx-id"),c.data("index"))},d));c.on("keypress",function(a){a.which===13&&c.click()})},d=this;for(a=0;a<b.length;a++)c()};QuestionnaireListController.prototype.startQnrController=function(c,b,a,f,e,d){if(!f)this.startGeneralQuestionnaire(c,b,a);else this.startHistoryQuestionnaire(c,b,a,e,d)};QuestionnaireListController.prototype.startGeneralQuestionnaire=function(i,h,g){var f,d;b.ListUtility.hidePageElements();b.Utility.showElement($afe.select(c));f=b.Ui.getDomElementsForQuestionnaireView();var e=new b.DisplaySettings;e.modifyHistory=!$$WP.Utilities.UI.IsMobile;d=new b.QuestionnaireWorkflowInformation(this.qnrHandler,h,g,e);this.qnrController=new a.PatientEngagement.Questionnaire.MyChart.QuestionnaireController(i,f,d);this.qnrController.start()};QuestionnaireListController.prototype.startHistoryQuestionnaire=function(g,e,c,f,d){var a="";if(e===b.QuestionnaireContextType.Contact){a=HTMLUnencode(b.QuestionnaireUrls.histUrlApptBase)+g+"_"+f+"_"+d+"__"+c;$$WP.Utilities.TryRedirect(makeLink(a),null,"1")}else if(e===b.QuestionnaireContextType.Message){a=HTMLUnencode(b.QuestionnaireUrls.histUrlMsgBase)+c+HTMLUnencode(b.QuestionnaireUrls.histTaskParam)+d;$$WP.Utilities.TryRedirect(makeLink(a),null,"1")}};return QuestionnaireListController}();d.QuestionnaireListController=c})(c=b.MyChart||(b.MyChart={}))})(c=b.Questionnaire||(b.Questionnaire={}))})(b=a.PatientEngagement||(a.PatientEngagement={}))})(Epic||(Epic={}))