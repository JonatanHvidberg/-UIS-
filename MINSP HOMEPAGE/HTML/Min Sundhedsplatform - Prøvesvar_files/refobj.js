/*! Copyright (c) Epic Systems Corporation 2017-2019 */
$$WPUtil.guaranteeExistence($$WP,"Clinical.TestResultsPOC.Components");$$WP.Clinical.TestResultsPOC.Components.RefObj=function $$WP$Clinical$Components$RefObj(){};$$WP.Clinical.TestResultsPOC.Components.RefObj.prototype={_invalidNumber:function $$WP$Cln$refobj$_invalidNumber(a){return isNaN(a)||typeof a!=="number"},_validString:function $$WP$Cln$refobj$_validString(a){return a!==null&&a!==undefined&&a.length>0},_percentageOfWidth:function $$WP$Cln$refobj$_percentageOfWidth(c,a,b){return(c-a)/(b-a)},_getText:function $$WP$Cln$refobj$_getText(a){return a.isMin?"":a.dispMin},_createScale:function $$WP$Cln$refobj$_createScale(b,a){var c=a[1]-a[0],d=b[1]-b[0];return function(b){return(b-a[0])/c*d}},_lengthCalc:function $$WP$Cln$refobj$_lengthCalc(a){return a.toString().length*-4+"px"},_createSVG:function $$WP$Cln$refobj$_createSVG(d,b){var a=$afe.jq(document.createElementNS("http://www.w3.org/2000/svg",d));for(var c in b)a.safeAttr(c,b[c]);return a},_addAltText:function $$WP$Cln$refobj$_addAltText(i,e,f,d,j){var h="GraphAltText",b="@MYCHART@GraphAltReferenceRange@",g="@MYCHART@GraphAltValue@";if(this._validString(d)){e+=" "+d;f+=" "+d}var a=$$WP.Strings.getNamespace("Clinical.TestResults");a.addMnemonic(g,e,$$WP.Strings.EncodingTypes.None);a.addMnemonic(b,f,$$WP.Strings.EncodingTypes.None);var c=a.getString(h);i.safeAttr("title",c);a.addMnemonic(b,j,$$WP.Strings.EncodingTypes.None);c=a.getString(h);$clearLabel=$$WP.SimpleTemplates.Span({"class":"clearlabel"},c);i.safeAppend($clearLabel);a.removeMnemonic(g);a.removeMnemonic(b)},CreateRefObj:function $$WP$Cln$refobj$CreateRefObj(b){var m=true,a=this,f=b.max,g=b.min,h=b.val,Q=b.unit,n=b.target,y=b.dispVal,L=b.dispMin,K=b.dispMax,F=b.referenceRange,C=b.ariaReferenceRange,D=b.showRefRangeValues;if(a._invalidNumber(g)||a._invalidNumber(f)||a._invalidNumber(h))return false;a._addAltText(n,y,F,Q,C);var z=(f-g)/2,d=f+z,e=g-z,x=a._percentageOfWidth(h,e,d);if(x<.1)e=(h-.1*d)/.9;else if(x>.9)d=(h-.1*e)/.9;var O=a._percentageOfWidth(f,e,d)-a._percentageOfWidth(g,e,d);if(O<.2)return false;var p=b.width,k=b.height,o=a._createScale([0,p],[e,d]),c={left:2,top:30},j=0,v=[{min:e,max:g,cssClass:"ptLeft",cumulativeMargin:0,isMin:m},{min:g,max:f,dispMin:L,cssClass:"ptMid",cumulativeMargin:j+=c.left,isVal:m},{min:f,max:d,dispMin:K,cssClass:"ptRight",cumulativeMargin:j+=c.left,isMax:m}];n.css("min-height",k+"px");n.css("width",p+j+"px");var N="0 0 "+(p+j)+" "+(k+60),q=a._createSVG("svg",{"class":"refRangeGraphSvg",height:k+60,width:p+j,viewBox:N,preserveAspectRatio:"xMidYMid meet","aria-hidden":"true","shape-rendering":"crispEdges"});n.safeAppend(q);for(var t=0;t<v.length;t++){var i=v[t],s=a._createSVG("g",{"class":"rectGroup",transform:"translate("+(o(i.min)+i.cumulativeMargin)+","+c.top+")"});q.safeAppend(s);var P=a._createSVG("rect",{"class":i.cssClass,width:o(i.max)-o(i.min),height:k});s.safeAppend(P);if(D){var B=a._getText(i),A=a._createSVG("text",{y:c.top+k-5,x:a._lengthCalc(B)});A.text(B);s.safeAppend(A)}}var H=h<g?0:h>f?2:1,G=H*c.left,r=10,u=6,l=o(h)+G,J=l-r/2,I=l+r/2,R=l+","+c.top,S=J+","+(c.top-u),T=I+","+(c.top-u),E="M "+R+" "+S+" "+T+" z",M=a._createSVG("path",{"class":"markerPointer","data-baseWidth":r,d:E});q.safeAppend(M);var w=a._createSVG("text",{"class":"markerText",height:"40",x:l,y:c.top-10,"text-anchor":"middle"});w.safeAppend(y);q.safeAppend(w);return m}}