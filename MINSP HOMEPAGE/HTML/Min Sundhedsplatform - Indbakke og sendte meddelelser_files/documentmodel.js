(function ClassDefinition(){var m="Home/Error/",l="matchColumnHeights",u=".esigned",j="title",h="width",z=".documentpopup object",v=".documentpopup .loadingHeart",c="popupResize",y="resize.pdfViewer",t="height",x=".Popup.documentpopup",s="MPEG",r="3GPP",q="WEBMA",p="WEBMV",o="WEBM",f="audio",g="video",n="TIFF",i="PDF",w="&fncExtID=",k="&dcsId=",d=true,a=false,e=null;PDF_ICON_URL=makeStaticLink("images/document_pdf.svg");TIFF_ICON_URL=makeStaticLink("images/document_tiff.svg");ESIGN_ICON_URL=makeStaticLink("images/document_esigned.svg");VIDEO_ICON_URL=makeStaticLink("images/document_vid.svg");AUDIO_ICON_URL=makeStaticLink("images/document_audio.svg");NON_PDF_ICON_URL=makeStaticLink("images/document_img.svg");$$WP.Utilities.guaranteeExistence($$WP,"Documents.ViewDocument.Models");var b=$$WP.Strings.getNamespace("viewdocument"),A=function DocumentModel(a,e,o,n,l,m,k,p,q,d,c,g,f,i,j,h){var b=this;if(!a){a={};a.DocID=o;a.DcsID=n;a.DocType=l;a.DocExt=m;a.DocDesc=k;a.Date=p;a.DAT=q;a.PendingApprovalStatus=d;a.RejectionReasonFreetext=c;a.WasESigned=g;a.DownloadOnly=f;a.FncExtID=i}b.LetterID=j;b.IsHNOOnly=Boolean(h);b.Template=$$WP.Templates.Documents.ViewDocument.Document;b.WP$Common$Model(a);b.setStatusInfo(a.PendingApprovalStatus,a.RejectionReasonFreetext);b.makeUrl();b.setupDocType();b.setStrings(e)};A.prototype={s_dataMembers:["DocID","DcsID","DocType","DocExt","Date","DocDesc","WasESigned","DAT","DownloadOnly","FncExtID","New","DateRaw","IsExpired"],DocID:e,DcsID:e,DocType:e,DocExt:e,Date:e,DAT:e,DocDesc:e,WasESigned:e,DownloadOnly:a,FncExtID:e,New:a,DateRaw:e,IsExpired:a,Url:e,DownloadUrl:e,IconUrl:e,Template:e,ToolTipString:e,TimeStampString:e,PendingApproval:a,Rejected:a,RejectionReason:"",BadgeHoverText:"",BadgeText:"",LetterID:e,IsHNOOnly:a,MediaType:"",MimeType:"",AllowPreview:d,AllowPrint:d,AllowDownload:d,makeUrl:function makeUrl(){var a=this,b="Documents/ViewDocument/Download/?docId="+a.DocID+k+a.DcsID;if(a.FncExtID)b=b+w+a.FncExtID;a.DownloadUrl=makeLink(b)},setupDocType:function setupDocType(){var e="documentAudioIconAltText",h="documentVideoIconAltText",l="documentImageIconAltText",j="&method=view",c=this;c.AllowPreview=d;c.AllowDownload=d;c.AllowPrint=d;switch(c.DocExt){case i:c.IconUrl=PDF_ICON_URL;c.IconAltText=b.getStringForTemplate("documentPDFIconAltText");c.Template=$$WP.Templates.Documents.ViewDocument.PDFDocument;c.Url=c.DownloadUrl+j;c.AllowDownload=a;if(WP.DOM.Browser.isEdge||WP.DOM.Browser.isSafari)c.AllowDownload=d;break;case"PCX":c.DownloadOnly=d;c.IconUrl=NON_PDF_ICON_URL;c.IconAltText=b.getStringForTemplate(l);break;case n:case"TIF":c.IconUrl=TIFF_ICON_URL;c.IconAltText=b.getStringForTemplate("documentTiffIconAltText");c.Template=$$WP.Templates.Documents.ViewDocument.TiffDocument;c.Url=makeLink("Documents/ViewDocument/GetTiff?docId="+c.DocID+k+c.DcsID+(c.FncExtID?w+c.FncExtID:""));break;case"MP4":case"M4V":c.IconUrl=VIDEO_ICON_URL;c.IconAltText=b.getStringForTemplate(h);c.Template=$$WP.Templates.Documents.ViewDocument.VideoDocument;c.MediaType=g;c.MimeType="video/mp4";break;case"M4A":c.IconUrl=AUDIO_ICON_URL;c.IconAltText=b.getStringForTemplate(e);c.Template=$$WP.Templates.Documents.ViewDocument.VideoDocument;c.MediaType=f;c.MimeType="audio/mp4";break;case"MP3":c.IconUrl=AUDIO_ICON_URL;c.IconAltText=b.getStringForTemplate(e);c.Template=$$WP.Templates.Documents.ViewDocument.VideoDocument;c.MediaType=f;c.MimeType="audio/mp3";break;case o:case p:c.IconUrl=VIDEO_ICON_URL;c.IconAltText=b.getStringForTemplate(h);c.Template=$$WP.Templates.Documents.ViewDocument.VideoDocument;c.MediaType=g;c.MimeType="video/webm";break;case q:c.IconUrl=AUDIO_ICON_URL;c.IconAltText=b.getStringForTemplate(e);c.Template=$$WP.Templates.Documents.ViewDocument.VideoDocument;c.MediaType=f;c.MimeType="audio/webm";break;case"OGG":case"OGV":c.IconUrl=VIDEO_ICON_URL;c.IconAltText=b.getStringForTemplate(h);c.Template=$$WP.Templates.Documents.ViewDocument.VideoDocument;c.MediaType=g;c.MimeType="video/ogg";break;case"OGA":c.IconUrl=AUDIO_ICON_URL;c.IconAltText=b.getStringForTemplate(e);c.Template=$$WP.Templates.Documents.ViewDocument.VideoDocument;c.MediaType=f;c.MimeType="audio/ogg";break;case"FLV":case"MOV":case"3GP":case r:case"MPG":case s:case"WMV":case"AVI":c.IconUrl=VIDEO_ICON_URL;c.IconAltText=b.getStringForTemplate(h);c.Template=$$WP.Templates.Documents.ViewDocument.VideoDocument;c.MediaType=g;break;case"WAV":c.IconUrl=AUDIO_ICON_URL;c.IconAltText=b.getStringForTemplate(e);c.Template=$$WP.Templates.Documents.ViewDocument.VideoDocument;c.MediaType=f;break;case"HTML":c.IconUrl=ESIGN_ICON_URL;c.IconAltText=b.getStringForTemplate("documentESignIconAltText");c.IsHTML=d;if(c.IsHNOOnly)c.Template=$$WP.Templates.Documents.ViewDocument.LetterNote;else c.Template=$$WP.Templates.Documents.ViewDocument.ESignedDocument;c.Url=c.DownloadUrl+j;break;default:c.IconUrl=NON_PDF_ICON_URL;c.Url=c.DownloadUrl+j;c.IconAltText=b.getStringForTemplate(l)}if(["DOC","DOCX","MP4","M4V","M4A","MP3",o,p,q,"OGG","OGV","OGA","FLV","MOV","3GP",r,"MPG",s,"WMV","AVI","WAV"].indexOf(c.DocExt)!==-1){c.AllowPreview=a;c.AllowPrint=a}if($$WP.Utilities.UI.IsMobile){c.AllowPrint=a;c.AllowDownload=a;if([i].indexOf(c.DocExt)!==-1)c.AllowPreview=a}},setStrings:function setStrings(e){var m="@MYCHART@DOCTYPE@",l="noFilePreview",f="@MYCHART@FILEEXTENSION@",k="cannotDisplayMobile",c="@MYCHART@DOWNLOADLINK@",j="@MYCHART@DATEADDED@",h="@MYCHART@DATEUPLOADED@",g="@MYCHART@DATESIGNED@",a=this;if(a.WasESigned==="1"||a.WasESigned===d){$$WP.Strings.addMnemonic(g,a.Date);a.TimeStampString=b.getStringForTemplate("signed");$$WP.Strings.removeMnemonic(g)}else if(a.Rejected||a.PendingApproval){$$WP.Strings.addMnemonic(h,a.Date);a.TimeStampString=b.getStringForTemplate("uploaded","documents.viewdocument");$$WP.Strings.removeMnemonic(h);if(a.PendingApproval){a.BadgeHoverText=b.getString("pendingDocumentBadgeHoverText");a.BadgeText=b.getString("pendingDocumentBadgeText");if(e.PendingBadgeText)a.BadgeText=e.PendingBadgeText}if(a.Rejected){a.BadgeHoverText=b.getString("rejectedDocumentBadgeHoverText");a.BadgeText=b.getString("rejectedDocumentBadgeText");if(e.RejectedBadgeText)a.BadgeText=e.RejectedBadgeText}}else{$$WP.Strings.addMnemonic(j,a.Date);a.TimeStampString=b.getStringForTemplate("added");$$WP.Strings.removeMnemonic(j);if(e.AcceptedBadgeText)a.BadgeText=e.AcceptedBadgeText}if(a.IsExpired){a.BadgeHoverText=b.getString("expiredDocumentBadgeHoverText");a.BadgeText=b.getString("expiredDocumentBadgeText");if(e.ExpiredBadgeText)a.BadgeText=e.ExpiredBadgeText}if(a.DocExt===i){b.addMnemonic(c,a.DownloadUrl,$$WP.Strings.EncodingTypes.None);if($afe.select("html").hasClass("mobile"))a.FallbackText=b.getStringForTemplate(k);else a.FallbackText=b.getStringForTemplate("noEmbeddedPdf");b.removeMnemonic(c)}else if(a.DocExt===n||a.DocExt==="TIF"){b.addMnemonic(c,a.DownloadUrl,$$WP.Strings.EncodingTypes.None);if($$WP.Utilities.UI.IsMobile)a.FallbackText=b.getStringForTemplate(k);else{$$WP.Strings.addMnemonic(c,a.DownloadUrl,$$WP.Strings.EncodingTypes.None);a.FallbackText=b.getStringForTemplate("noAcordex");$$WP.Strings.removeMnemonic(c)}b.removeMnemonic(c)}else if(["DOC","DOCX","MP4","M4V","M4A","MP3",o,p,q,"OGG","OGV","OGA","FLV","MOV","3GP",r,"MPG",s,"WMV","AVI","WAV"].indexOf(a.DocExt)!==-1)if($$WP.Utilities.UI.IsMobile)a.FallbackText=b.getStringForTemplate("useComputerToDownload");else{b.addMnemonic(f,a.DocExt);a.FallbackText=b.getString(l);b.removeMnemonic(f)}else{b.addMnemonic(f,a.DocExt);a.FallbackText=b.getString(l);b.removeMnemonic(f)}b.addMnemonic(m,a.DocType,$$WP.Strings.EncodingTypes.None);a.ToolTipString=b.getString("documenttooltip");b.removeMnemonic(m)},openAsPopup:function openPopup(q){var b=this,l,m,k;l=new $$WP.Documents.ViewDocument.Components.DocumentComponent(b);m={HasOverlay:d,Size:b.AllowPreview?$$WPContain.Popup.SizeEnum.LARGE:$$WPContain.Popup.SizeEnum.SMALL,Class:"documentpopup "+q,positioningFunction:$$WPContain.Positions.InsideNearTop,HasBackButton:a};k=$$WPUtil.quickPopup(l,m);k.addEventListener("click",$.proxy(b._onClick,b,k));if($$WP.Utilities.UI.IsMobile&&(b.DocExt===n||b.DocExt==="TIF")){var p=$afe.select(x),r=b._computeRemainingHeightOfPopup(p);p.find("iframe.tiffviewer").css(t,r+"px")}if(b.DocExt===i){b._pfdResize();$afe.jq(window).on(y,b._pfdResize)}if(b.WasESigned==="1"||b.WasESigned===d)return a;var e=$afe.jq($afe.select(".documentpopup img#section-to-print")),j=0;$afe.jq(e).on("load",function(){$afe.jq(window).trigger(c);$afe.jq(window).trigger("resize");j++;j==e.length&&$afe.select(v).remove()});$afe.jq(e).on("error",$.proxy(b._onImageFailure,b));if(e.length>0){var u=b;setTimeout(function(){e.length!==j&&u._onImageFailure(2)},3e4)}var h=$.proxy(b._resize,b),o=$afe.select(".documentpopup video");(b.MediaType==f||b.MediaType==g)&&initAllPlayers();$afe.jq(o).on("loadeddata",h);$afe.jq(o).on("error",h);var s=$afe.select(z);$afe.jq(s).on("load",h);return a},_onClick:function(c,b){if(b.dataId===$$WPComp.TOOLBARIDENTIFIER+"downloadfile"){this._initiateDownload();b.stopPropagation();b.preventDefault();c.dispose();return a}else if(b.dataId==="downloadIcon"){this._initiateDownload();return a}else if(b.dataId==="printIcon"){this.PrintClicked(b);return a}return d},_initiateDownload:function(){var b="uploadWidget-downloadFrame",a;if(this.DownloadUrl.length>0){a=$afe.select("iframe#uploadWidget-downloadFrame");if(!a||a.length===0){a=$afe.jq(document.createElement("iframe"));a.safeAttr("name",b);a.safeAttr("id",b);a.prop(h,"0");a.prop(t,"0");$afe.jq(document.body).safeAppend(a)}a.prop("src",this.DownloadUrl)}},_sendDownloadUrl:function(){$$WP.Utilities.TryRedirect(makeLink("Documents/ViewDocument?dcsid="+this.DcsID))},_onImageFailure:function(e){var d=this.FallbackText,a=$afe.select(".viewdocument-popup--error");if(e===2)d=b.getString("errorLoadTime");$afe.select(v).remove();$afe.select(".documentpopup #section-to-print").remove();$afe.select(".documentpopup .options").remove();dangerou$.setHtml(a,d);a.removeClass("hidden");$afe.jq(window).trigger(c)},_resize:function(){$afe.jq(window).trigger(c);$afe.select(".loadingHeart").remove()},_pfdResize:function(){var b=$afe.select(x).get(0);if(typeof b!=="undefined"&&b!==e){var c=b.getBoundingClientRect(),d=$(window).height(),a=d-c.top-175;if(a<1)a=1e3;$afe.select(z).height(a)}else $afe.jq(window).off(y,"",this._pfdResize)},_computeRemainingHeightOfPopup:function _computeRemainingHeightOfPopup(a){var b=parseInt(a.find(".content").first().css("max-height"),10);if(!isNaN(b))return b-a.height()-10;else{var c=a.get(0).getBoundingClientRect();return $(window).height()-c.bottom-10}},PrintClicked:function(){var k="min-height",b="inherit",i="padding",f="printFrame",q,m,g,c,d,l,o;g=document.getElementById(f);if(!g){g=document.createElement("iframe");c=$afe.jq(g);c.safeAttr("name",f);c.safeAttr("id",f);c.prop(h,"0");c.prop(t,"0");c.prop("src","about:blank");$afe.jq(document.body).safeAppend(c);c.contents().find("head").safeAppend($afe.jq(document.createElement(j)));c.load(function(){var b=document.getElementById(f);b.contentWindow.focus();if(WP.DOM.Browser.isIE)b.contentWindow.document.execCommand("print",a,e);else b.contentWindow.print()})}c=$afe.jq(g);l=c.contents().find("head");l.find(j).text($afe.select(".titlebar span")[0].innerHTML);d=c.contents().find("body");m=$afe.select(u);if(m.length>0)dangerou$.setHtml(d,m[0].innerHTML);else dangerou$.setHtml(d,$afe.select("#section-to-print")[0].outerHTML.replace("method=view","method=print"));d.find("._headerContent").css(i,b).css(h,b).css(k,b);d.find("._mainContent").css(i,b).css(h,b).css(k,b);d.find("._footerContent").css(i,b).css(h,b).css(k,b);d.find("canvas").css("background-color","#eee").css("border","1px #ccc solid");images=d.find("img");for(var n=0;n<images.length;n++){var p=$afe.jq(images[n]);p.css("max-width","7in")}o=navigator.userAgent.toLowerCase().indexOf("safari/")>-1&&navigator.userAgent.toLowerCase().indexOf("chrome/")===-1;if(o)setTimeout(function(){g.contentWindow.document.write(l[0].outerHTML+d[0].outerHTML);g.contentWindow.document.close()},200);else{g.contentWindow.document.write(l[0].outerHTML+d[0].outerHTML);g.contentWindow.document.close()}return a},openAsNewPage:function openAsNewPage(){var a=makeLink("Documents/ViewDocuments/ViewDocument?dcsId="+this.DcsID+"&docId="+this.DocID);window.location=a},setStatusInfo:function setStatusInfo(c,e){var b=this;if(c===1){b.PendingApproval=d;b.Rejected=a;b.New=a}else if(c===2){b.PendingApproval=a;b.Rejected=d;b.RejectionReason=e;b.New=a}else{b.PendingApproval=a;b.Rejected=a}},displayESign:function displayESign(){var a=this,e=a.DcsID,f=a.DAT,d="";if(a.FncExtID)d=a.FncExtID;getCSRFTokenAsQS(function(a){$.ajax({type:"POST",url:makeLink("Documents/ESignatures/LoadESignDocContent"),data:a+k+e+"&eptDAT="+f+"&fncExtId="+d,dataType:"json",success:function(d){var a=$afe.select(u);dangerou$.setHtml(a,d);$afe.select("img").each(function(b,a){a.onload=function(){$afe.jq(window).trigger(c)};a.onerror=function(){$afe.jq(window).trigger(c)}});$afe.select("canvas").attr(j,b.getStringForTemplate("unsignedField"));$afe.jq(window).trigger(l)},error:function(){link=makeLink(m);window.location=link}})})},displayHNO:function displayHNO(){$.ajax({type:"POST",url:this.Url,dataType:"json",success:function(b){var a=$afe.select(".letterNote");dangerou$.setHtml(a,b);$afe.select("img").each(function(b,a){a.onload=function(){$afe.jq(window).trigger(c)};a.onerror=function(){$afe.jq(window).trigger(c)}});$afe.jq(window).trigger("resize");$afe.jq(window).trigger(l)},error:function(){link=makeLink(m);window.location=link}})}};$$WP.Documents.ViewDocument.Models.DocumentModel=A;A.extend($$WP.Common.Model,"WP$Documents$ViewDocument$Models$DocumentModel")})()