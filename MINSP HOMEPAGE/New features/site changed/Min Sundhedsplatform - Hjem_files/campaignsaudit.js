/*! Copyright (c) Epic Systems Corporation 2017-2018 */
$$WP.CampaignOutreach=$$WP.CampaignOutreach||{};$$WP.CampaignOutreach.CampaignsAudit=function CampaignOutreach$CampaignsAudit(c){var a=this;a._viewModel=c;a._unseenCardOutreachIDs=[];for(var b=0;b<a._viewModel.length;b++)a._unseenCardOutreachIDs.push(a._viewModel[b].CardOutreachID)};$$WP.CampaignOutreach.CampaignsAudit.prototype={_cardActions:{Seen:4,InfoClicked:5,ActionClicked:6},_viewModel:null,_unseenCardOutreachIDs:[],addHandlers:function WP$CampaignOutreach$CampaignsAudit$_addHandlers(){var a=this;a.auditSeenCards();window.onscroll=$.proxy(a.auditSeenCards,a);var b=$afe.select(".campaignButton, .campaignLink"),c=$.proxy(function(a){$$WP.CampaignOutreach.ValidateEvent(a,$.proxy(this._buttonHandler,this))},a);b.on("mouseup click",$.proxy(c));b.focus($.proxy(a._buttonFocusHandler,a))},_buttonFocusHandler:function WP$CampaignOutreach$CampaignAudit$_buttonFocusHandler(b){var a=b.target.getAttribute("data-outreach-id");this._unseenCardOutreachIDs.indexOf(a)>-1&&this._sendAudit(a,this._cardActions.Seen)},_buttonHandler:function WP$CampaignOutreach$CampaignsAudit$_buttonHandler(f){var a=this,c=f.target,b=c.getAttribute("data-outreach-id"),d=c.classList.contains("campaignLink"),e=d?a._cardActions.InfoClicked:a._cardActions.ActionClicked;a._sendAudit(b,e);a._updateCardViewModel(b)},_updateCardViewModel:function WP$CampaignsOutreach$CampaignsAduit$_updateCardViewModel(c){for(var b=0;b<this._viewModel.length;b++){var a=this._viewModel[b];if(a&&a.Buttons&&a.Buttons.length>0&&c===a.CardOutreachID)if(a.Buttons[0].IsActionHyperlinkButton)a.WasButtonLinkVisited=true}},auditSeenCards:function WP$CampaignOutreach$CampaignsAudit$auditSeenCards(){var a=this,b=a._checkNewlySeenCards();b!==null&&b!==""&&a._sendAudit(b,a._cardActions.Seen);if(a._unseenCardOutreachIDs.length===0)document.body.onscroll=null},_sendAudit:function WP$CampaignOutreach$CampaignsAudit$_sendAudit(a,b){$.post({url:makeLink("CampaignOutreach/Campaigns/AuditCards"),data:{OutreachContacts:a,OutreachAction:b},cache:false,suppressEpicDefaultAjaxErrorHandler:true})},_checkNewlySeenCards:function WP$CampaignOutreach$CampaignsAudit$_checkNewlySeenCards(){var a=this;for(var d="",b=a._unseenCardOutreachIDs.length-1;b>=0;b--){var e=a._unseenCardOutreachIDs[b],c=document.getElementById(e);if(!c)a._unseenCardOutreachIDs.splice(b,1);else if(c&&a._inViewport(c)){d+=e+",";a._unseenCardOutreachIDs.splice(b,1)}}return d},_inViewport:function WP$CampaignOutreach$CampaignsAudit$_inViewport(a){var g=a.getBoundingClientRect().top,d=a.getBoundingClientRect().bottom,f=a.getBoundingClientRect().left,e=a.getBoundingClientRect().right,c=g>=0&&d<=window.innerHeight,b=f>=0&&e<=window.innerWidth;return c&&b}}